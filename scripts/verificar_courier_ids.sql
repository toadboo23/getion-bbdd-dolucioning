-- VERIFICAR ESTADO DE COURIER IDs EN LA BASE DE DATOS

-- 1. Crear tabla temporal con los IDs a verificar
CREATE TEMP TABLE courier_ids_to_check (
    id_glovo VARCHAR(20)
);

-- 2. Insertar todos los IDs
INSERT INTO courier_ids_to_check (id_glovo) VALUES
('184067316'),('184067320'),('184067322'),('184067333'),('184067338'),('184067343'),('184067345'),('184067348'),('184067358'),('184067360'),
('184067363'),('184067367'),('184067370'),('184067421'),('184067426'),('184067427'),('184067429'),('184067433'),('186706439'),('186706457'),
('186706461'),('186706467'),('186706472'),('186726878'),('186726879'),('186726885'),('187007636'),('187287175'),('187287212'),('187584219'),
('187584233'),('187584235'),('187897140'),('187897149'),('187897167'),('187897173'),('187897174'),('187897177'),('187897180'),('187897186'),
('187897190'),('188075172'),('188075222'),('188273276'),('188273296'),('188273300'),('188273301'),('188273304'),('188273307'),('188273309'),
('188273310'),('188288097'),('188288107'),('188288120'),('188335603'),('188335605'),('188335607'),('188385566'),('188438996'),('188439220'),
('188439448'),('188738456'),('188738474'),('188738493'),('188842026'),('188842035'),('188842037'),('188842088'),('188988861'),('188988871'),
('188988873'),('188988877'),('188988881'),('188988883'),('188988884'),('188988893'),('188988923'),('188994465'),('188994467'),('189351208'),
('189351216'),('189351218'),('189351342'),('189351345'),('189351348'),('189351350'),('189351353'),('189351360'),('189351905'),('189351926'),
('189351931'),('189351935'),('189351939'),('189448402'),('189448406'),('189448411'),('189448415'),('189448416'),('189448421'),('189448422'),
('189448425'),('189448428'),('189448435'),('189448439'),('189448451'),('189448452'),('189448454'),('189557734'),('189557736'),('189557752'),
('189557753'),('189557754'),('189557756'),('189557757'),('189557760'),('189557761'),('189667554'),('189667585'),('189667595'),('189667598'),
('189667599'),('189667607'),('189667658'),('189785028'),('189785051'),('189785062'),('189785066'),('189785070'),('189785074'),('189785085'),
('190147075'),('190147186'),('190147197'),('190147198'),('190147200'),('190147201'),('190147203'),('190236125'),('190236126'),('190236128'),
('190236133'),('190236135'),('190236137'),('190236144'),('190236147'),('190236152'),('190236153'),('190236155'),('190236156'),('190236182'),
('190261803'),('190282046'),('190291802'),('190291813'),('190291814'),('190291884'),('190291887'),('190291892'),('190291902'),('190291912'),
('190501028'),('190501099'),('190503567'),('190503987'),('190504734'),('190504739'),('190505307'),('190506429'),('190506445'),('190506653'),
('190582679'),('190582683'),('190582685'),('190582688'),('190582690'),('190582692'),('190582696'),('190582698'),('190582765'),('190582771'),
('191123325'),('191123336'),('191123351'),('191326277'),('191326386'),('191326689'),('191326704'),('191327670'),('191327685'),('191327688'),
('191327699'),('191342907'),('191486129'),('191487491'),('191487493'),('191487497'),('191487499'),('191487501'),('191487543'),('191487546'),
('191487550'),('191487558'),('191487567'),('191487568'),('191487782'),('191487783'),('191669751'),('191669766'),('191673445'),('191673456'),
('191683114'),('191683121'),('191683132'),('191683134'),('191683142'),('191683152'),('191683220'),('191715862'),('191725571'),('191725579'),
('191725580'),('191725582'),('191725586'),('191725664'),('191725669'),('191725671'),('191725673'),('191725678'),('191725682'),('191978378'),
('191978379'),('191978390'),('191978427'),('191978431'),('191978437'),('191978454'),('191978459'),('191978490'),('191978493'),('191978655'),
('191978682'),('191978691'),('191978703'),('191978704'),('191978706'),('191978707'),('191978721'),('191978731'),('191978739'),('191978743'),
('191978750'),('191978768'),('191978773'),('191978781'),('191978815'),('191978817'),('191978862'),('191978865'),('191979803'),('192151529'),
('192151537'),('192151539'),('192151542'),('192151546'),('192151554'),('192151560'),('192151563'),('192151573'),('192151578'),('192151582'),
('192151584'),('192151680'),('192151691'),('192151709'),('192151711'),('192151717'),('192370630'),('192370631'),('192370634'),('192370696'),
('192370769'),('192370773'),('192370782'),('192370791'),('192370797'),('192370813'),('192370818'),('192370821'),('192370827'),('192371055'),
('192371059'),('192371061'),('192635658'),('192635693'),('192635694'),('192635702'),('192635713'),('192635715'),('192635717'),('192635718'),
('192847027'),('192847040'),('192847046'),('192847047'),('192847056'),('192847063'),('192847064'),('192847077'),('192847083'),('192847090'),
('192847091'),('192847093'),('192847099'),('192847102'),('192847107'),('192847127'),('192847139'),('192847141'),('193144213'),('193144214'),
('193144215'),('193144218'),('193144223'),('193144240'),('193144247'),('193192761'),('193192811'),('193192814'),('193192815'),('193192825'),
('193192826'),('193192828'),('193192840'),('193192864'),('193192870'),('193192903'),('193192905'),('193192906'),('193192907'),('193192909'),
('193192910'),('193396578'),('193396765'),('193396767'),('193396799'),('193396806'),('193396808'),('193441906'),('193446200'),('193592405'),
('193607552'),('193607553'),('193607579'),('193607581'),('193607584'),('193607589'),('193607598'),('193607600'),('193607639'),('193607640'),
('193607647'),('193607655'),('193607844'),('193607850'),('193607855'),('193607857'),('193607861'),('193607863'),('193607890'),('193607892'),
('194079880'),('194079882'),('194079897'),('194079903'),('194079906'),('194079933'),('194079934'),('194079943'),('194079951'),('194079962'),
('194079964'),('194079970'),('194079994'),('194080077'),('194080081'),('194789396'),('194789409'),('194789411'),('194789422'),('194789445'),
('194789449'),('194789695'),('194789709'),('194789742'),('194789753'),('194789765'),('194789776'),('194789778'),('194789800'),('194789819'),
('194789820'),('194789829'),('194789846'),('194789863'),('194789891'),('195007273'),('195007282'),('195007362'),('195008909'),('195060133'),
('195082865'),('195082880'),('195082882'),('195312634'),('195312641'),('195312642'),('195312655'),('195312658'),('195312660'),('195312661'),
('195312855'),('195312873'),('195339434'),('195339440'),('195339445'),('195339481'),('195628873'),('195628878'),('195629021'),('195629022'),
('195629026'),('195629207'),('195629213'),('195629216'),('195629219'),('195629222'),('195629224'),('195629244'),('195629252'),('195629253'),
('195629258'),('195629419'),('195658675'),('195727411'),('195727591'),('196700430'),('196700434'),('196700438'),('196700443'),('196700659'),
('196700672'),('196700704'),('196700705'),('196700707'),('196700710'),('196700713'),('196700721'),('196700725'),('196700735'),('196700971'),
('196700976'),('196700980'),('196700983'),('196704062'),('197420902'),('197420915'),('197420939'),('197420950'),('197420952'),('197420960'),
('197420962'),('197420967'),('197420975'),('197420978'),('197420991'),('197420997'),('197421003'),('197421011'),('197421016'),('197421087'),
('197679895'),('197679897'),('197679939'),('197679940'),('197679942'),('197679943'),('197679945'),('197679949'),('197679951'),('197679952'),
('197679957'),('197679959'),('197680000'),('197680235'),('197680236'),('197680243'),('197680245'),('197680247'),('197680253'),('197680256'),
('197680259'),('197680261'),('197680295'),('197680299'),('197680301'),('197680303'),('197727468'),('197742927'),('197742935'),('197742936'),
('197742940'),('197742944'),('197742948'),('197742949'),('197742951'),('197742953'),('197742960'),('197742962'),('197742982'),('197743678'),
('197743680'),('197916914'),('197916918'),('197916922'),('197916923'),('197916924'),('197916933'),('197917001'),('197917008'),('197917017'),
('197917020'),('197917028'),('197917034'),('197917051'),('198018796'),('198018811'),('198018818'),('198018836'),('198085566'),('198085570'),
('198085576'),('198085589'),('198118970'),('198118972'),('198118973'),('198118974'),('198118976'),('198118978'),('198118980'),('198118999'),
('198435218'),('198435221'),('198435227'),('198435287'),('198435296'),('198435298'),('198435301'),('198435302'),('198435307'),('198435310'),
('198435313'),('198435314'),('198435316'),('198435324'),('198484116'),('198484126'),('198484127'),('198484129'),('198484158'),('198484164'),
('198484167'),('198484168'),('198484169'),('198484170'),('198484179'),('198520468'),('198520498'),('198520499'),('198520500'),('198520501'),
('198520504'),('198520524'),('198520531'),('198520532'),('198520540'),('199567185'),('199607317'),('199711453'),('199711975'),('199713372'),
('199713373'),('199713376'),('200034488'),('200415910'),('200415930'),('200415978'),('200415994'),('200416031'),('200416037'),('200416039'),
('200416042'),('200416049'),('200416054'),('200416055'),('200416056'),('200416083'),('200416091'),('200416099'),('200416120'),('200416124'),
('200416128'),('200416134'),('200416136'),('200416139'),('200416145'),('200459584'),('200634773'),('200634841'),('200638969'),('200638972'),
('200638997'),('200639002'),('200639008'),('200639044'),('200639051'),('200639052'),('200639063'),('200639071'),('200682451'),('200682465'),
('200682494'),('200682497'),('200684737'),('200684754'),('200684755'),('200684763'),('200684768'),('200684769'),('200684771'),('200684784'),
('200684785'),('200684790'),('200996373'),('200996399'),('200996427'),('200996431'),('200996437'),('200996438'),('200996454'),('200996460'),
('200996461'),('200996493'),('200996498'),('200996499'),('200996500'),('200997431'),('200997434'),('200997438'),('200997508'),('200997512'),
('201100002'),('201100009'),('201100019'),('201100070'),('201100080'),('201483002'),('201483005'),('201483026'),('201483032'),('201483034'),
('201483036'),('201483039'),('201483049'),('201483053'),('201483064'),('201483069'),('201483137'),('201483143'),('201483145'),('201483149'),
('201535527'),('201861029'),('201861056'),('201861058'),('201861059'),('201861061'),('201861062'),('201861066'),('201861075'),('201865759'),
('202226205'),('202236748'),('202239763'),('202300734'),('202412026'),('202412031'),('202412042'),('202412048'),('202786764'),('202786766'),
('202787675'),('202787680'),('202787694'),('202793765'),('202793766'),('202793769'),('202793773'),('202793776'),('202793777'),('202793779'),
('202793781'),('202793784'),('202793785'),('202793791'),('202793793'),('202793819'),('202793823'),('202793830'),('202793831'),('202793833'),
('202793834'),('202793837'),('202793839'),('202793841'),('202793844'),('202793928'),('202793930'),('202793932'),('202793934'),('202793983'),
('202793993'),('202794757'),('202794765'),('202844866'),('202844881'),('202844894'),('202844903'),('202844906'),('202844909'),('202844915'),
('202844920'),('202844922'),('202844924'),('202844927'),('202844933'),('202844938'),('202844940'),('202844942'),('202844949'),('202844954'),
('202844955'),('202844956'),('202844957'),('202844958'),('202844959'),('202844960'),('202844961'),('202844962'),('202844963'),('202844964'),
('202844966'),('202844967'),('202844970'),('202844971'),('202844973'),('202844974'),('202844975'),('202844976'),('202844979'),('202844981'),
('202844982'),('202844983'),('202844984'),('202844985'),('202844987'),('202844988'),('202844990'),('202844991'),('202844992'),('202844993'),
('202844994'),('202844995'),('202844996'),('202844997'),('202844998'),('202844999'),('202845000'),('202845001'),('202845002'),('202845003'),
('202845004'),('202845005'),('202845006'),('202845007'),('202845009'),('202845010'),('202845012'),('202845014'),('202845015'),('202845017'),
('202845018'),('202845022'),('202845024'),('202845026'),('202845027'),('202845029'),('202845030'),('202845031'),('202845032'),('202845033'),
('202845034'),('202845035'),('202845036'),('202845037'),('202845038'),('202845039'),('202845040'),('202845041'),('202845042'),('202845043'),
('202845044'),('202845047'),('202845048'),('202845050'),('202845052'),('202845055'),('202845109'),('202845110'),('202845111'),('202845112'),
('202845113'),('202845116'),('202889640'),('202889643'),('202889649'),('202889653'),('202889663'),('202889667'),('202889670'),('202889676'),
('202889678'),('202889686'),('202889690'),('202889694'),('202889696'),('202889700'),('202889752'),('202889781'),('202889784'),('202889786'),
('202889787'),('202889788'),('202889789'),('202889790'),('202889791'),('202898623'),('202898624'),('202898625'),('202898626'),('202898627'),
('202898628'),('202898629'),('202898630'),('202898631'),('202898633'),('202898636'),('202898638'),('202898640'),('202898643'),('202898644'),
('202898645'),('202898646'),('202898647'),('202898648'),('202898649'),('202898650'),('202898651'),('202898652'),('202898653'),('202898654'),
('202898655'),('202898656'),('202898657'),('202898658'),('202898659'),('202898660'),('202898661'),('202898662'),('202898663'),('202898665'),
('202898666'),('202898667'),('202898668'),('202898669'),('202898670'),('202898671'),('202898674'),('202898676'),('202898678'),('202898679'),
('202898680'),('202898681'),('202898682'),('202898683'),('202898684'),('202898686'),('202898687'),('202898689'),('202898690'),('202898691'),
('202898692'),('202898693'),('202898694'),('202898695'),('202898696'),('202898697'),('202898698'),('202898701'),('202898702'),('202898703'),
('202898704'),('202898705'),('202898706'),('202898707'),('202898708'),('202898709'),('202898710'),('202898711'),('202898712'),('202898713'),
('202898714'),('202898715'),('202898717'),('202898718'),('202898719'),('202898720'),('202898721'),('202898722'),('202898723'),('202898724'),
('202898725'),('202898726'),('202898728'),('202898730'),('202898731'),('202898732'),('202898733'),('202898734'),('202898735'),('202898736'),
('202898738'),('202898740'),('202898741'),('202898742'),('202898743'),('202898744'),('202898745'),('202898748'),('202898749'),('202898750'),
('202898752'),('202898754'),('202898757'),('202898758'),('202898759'),('202898760'),('202898764'),('202898765'),('202898767'),('202898768'),
('202898769'),('202898771'),('202898773'),('202898774'),('202898776'),('202898777'),('202898779'),('202898780'),('202903448'),('202903452'),
('202903456'),('202903458'),('202903459'),('202903460'),('202903461'),('202903462'),('202903463'),('202903465'),('202903467'),('203084238'),
('203085298'),('203085302'),('203085303'),('203085304'),('203086808'),('203086818'),('203086849'),('203089817'),('203089878'),('203090686'),
('203091126'),('203091354'),('203091370'),('203091489'),('203091511'),('203091588'),('203091752'),('203091802'),('203202210'),('203202220'),
('203202222'),('203202225'),('203202232'),('203202242'),('203202247'),('203202260'),('203202275'),('203202281'),('203202286'),('203202290'),
('203202294'),('203202296'),('203202298'),('203202301'),('203202309'),('203202316'),('203202317'),('203202323'),('203202327'),('203202332'),
('203202338'),('203202345'),('203202354'),('203202357'),('203202360'),('203268724'),('203268728'),('203268731'),('203268746'),('203268748'),
('203268752'),('203268757'),('203268763'),('203268766'),('203268788'),('203268792'),('203268808'),('203268809'),('203268813'),('203268822'),
('203268824'),('203268826'),('203268831'),('203268840'),('203268852'),('203268855'),('203268861'),('203312512'),('203312516'),('203312521'),
('203312522'),('203312525'),('203312529'),('203312538'),('203312541'),('203312545'),('203312547'),('203312550'),('203312552'),('203312556'),
('203312558'),('203312559'),('203312562'),('203312564'),('203312567'),('203312570'),('203312578'),('203312583'),('203312587'),('203312589'),
('203312590'),('203312591'),('203312592'),('203312593'),('203312596'),('203312602'),('203312604'),('203312611'),('203312618'),('203312621'),
('203312626'),('203312638'),('203312646'),('203312650'),('203312667'),('203312670'),('203312682'),('203312686'),('203312687'),('203312698'),
('203312717'),('203312724'),('203312727'),('203312736'),('203312742'),('203319019'),('203319022'),('203319023'),('203319024'),('203319026'),
('203319028'),('203319030'),('203319032'),('203319036'),('203319038'),('203319098'),('203319102'),('203319103'),('203319105'),('203319107'),
('203319336'),('203518001'),('203518251'),('203518255'),('203518266'),('203518267'),('203518269'),('203518539'),('203518540'),('203518545'),
('203518585'),('203519362'),('203519367'),('203519370'),('203519374'),('203519381'),('203519622'),('203519636'),('203519643'),('203519644'),
('203519971'),('203519978'),('203519979'),('203519981'),('203519983'),('203519989'),('203520237'),('203520241'),('203520271'),('203520290'),
('203520406'),('203520460'),('203525196'),('203525212'),('203525216'),('203525220'),('203525224'),('203525229'),('203525234'),('203525238'),
('203525240'),('203525241'),('203525246'),('203525248'),('203525314'),('203525320'),('203574155'),('203574200'),('203574202'),('203574214'),
('203574229'),('203574230'),('203574232'),('203736362'),('203736791'),('203736793'),('203736794'),('203736796'),('203736797'),('203736798'),
('203736799'),('203736801'),('203736816'),('203736817'),('203746405'),('203746420'),('203746421'),('203939905'),('203945992'),('204059803');

-- 3. Consulta principal: Comparar con tabla employees
SELECT 
    c.id_glovo,
    CASE 
        WHEN e.id_glovo IS NOT NULL THEN 'EN_EMPLOYEES'
        ELSE 'NO_EN_EMPLOYEES'
    END as estado_en_employees,
    e.nombre,
    e.apellido,
    e.status as status_employee,
    e.ciudad,
    e.horas,
    e.created_at as fecha_creacion_employee,
    e.updated_at as fecha_actualizacion_employee
FROM courier_ids_to_check c
LEFT JOIN employees e ON c.id_glovo = e.id_glovo
ORDER BY c.id_glovo;

-- 4. Consulta adicional: Buscar en company_leaves
SELECT 
    c.id_glovo,
    CASE 
        WHEN cl.employee_id IS NOT NULL THEN 'EN_COMPANY_LEAVES'
        ELSE 'NO_EN_COMPANY_LEAVES'
    END as estado_en_company_leaves,
    cl.leave_type as tipo_baja,
    cl.leave_date as fecha_baja,
    cl.status as status_company_leave,
    cl.approved_at as fecha_aprobacion,
    cl.approved_by as aprobado_por,
    cl.leave_requested_at as fecha_solicitud,
    cl.leave_requested_by as solicitado_por
FROM courier_ids_to_check c
LEFT JOIN company_leaves cl ON c.id_glovo = cl.employee_id
ORDER BY c.id_glovo;

-- 5. Resumen estadístico
SELECT 
    'TOTAL_IDS' as categoria,
    COUNT(*) as cantidad
FROM courier_ids_to_check
UNION ALL
SELECT 
    'EN_EMPLOYEES' as categoria,
    COUNT(*) as cantidad
FROM courier_ids_to_check c
INNER JOIN employees e ON c.id_glovo = e.id_glovo
UNION ALL
SELECT 
    'NO_EN_EMPLOYEES' as categoria,
    COUNT(*) as cantidad
FROM courier_ids_to_check c
LEFT JOIN employees e ON c.id_glovo = e.id_glovo
WHERE e.id_glovo IS NULL
UNION ALL
SELECT 
    'EN_COMPANY_LEAVES' as categoria,
    COUNT(*) as cantidad
FROM courier_ids_to_check c
INNER JOIN company_leaves cl ON c.id_glovo = cl.employee_id
UNION ALL
SELECT 
    'NO_EN_COMPANY_LEAVES' as categoria,
    COUNT(*) as cantidad
FROM courier_ids_to_check c
LEFT JOIN company_leaves cl ON c.id_glovo = cl.employee_id
WHERE cl.employee_id IS NULL;
